<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!-- Chart.js MAKE SURE YOU'RE USING THE MOST UPDATED VERSION! -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>


    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>

    <!-- Plugin CSS -->
    <link href="vendor/magnific-popup/magnific-popup.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/creative.min.css" rel="stylesheet">

    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>
<body>


<!-- BAR CHART -->

<div class="container">
    <canvas id="myBarChart"></canvas>
    <!--<canvas id="createCurrYearHccGapChart"></canvas>-->
</div>

<script>
    // todo Change the fonts

    var barOptions_stacked = {
        tooltips: {
            enabled: false
        },
        hover :{
            animationDuration:0
        },
        scales: {
            xAxes: [{
                ticks: {
                    beginAtZero:true,
                    fontFamily: "'Open Sans Bold', sans-serif",
                    fontSize:11
                },
                scaleLabel:{
                    display:false
                },
                gridLines: {
                },
                stacked: true
            }],
            yAxes: [{
                gridLines: {
                    display:false,
                    color: "#fff",
                    zeroLineColor: "#fff",
                    zeroLineWidth: 0
                },
                ticks: {
                    fontFamily: "'Open Sans Bold', sans-serif",
                    fontSize:11
                },
                stacked: true
            }]
        },
        legend:{
            display:false
        },

        animation: {
            onComplete: function () {
                var chartInstance = this.chart;
                var ctx = chartInstance.ctx;
                ctx.textAlign = "left";
                ctx.font = "9px Open Sans";
                ctx.fillStyle = "#fff";

                Chart.helpers.each(this.data.datasets.forEach(function (dataset, i) {
                    var meta = chartInstance.controller.getDatasetMeta(i);
                    Chart.helpers.each(meta.data.forEach(function (bar, index) {
                        data = dataset.data[index];
                        if(i==0){
                            ctx.fillText(data, 50, bar._model.y+4);
                        } else {
                            ctx.fillText(data, bar._model.x-25, bar._model.y+4);
                        }
                    }),this)
                }),this);
            }
        },
        pointLabelFontFamily : "Quadon Extra Bold",
        scaleFontFamily : "Quadon Extra Bold",
        title: {
            text: "Difficulty to access care",
            display: true
        },
        legend: {
            display: true,
        }
    };

    var ctx = document.getElementById("myBarChart");
    var myChart = new Chart(ctx, {
        type: 'horizontalBar',
        data: {
            labels: ["HIV Case Management", "Dental Care", "Counseling", "Information", "Alternative Therapy"],

            datasets: [{ // Easy
                label: ["Easy"],
                data: [277, 134, 54, 120, 29],
                backgroundColor: "rgb(83, 226, 119)",
                hoverBackgroundColor: "rgba(66, 175, 94, 1)"
            },{ // Possible but required some work
                label: ["Possible with some work"],
                data: [39, 67, 15, 32, 43],
                backgroundColor: "rgba(255, 233, 0, 1)",
                hoverBackgroundColor: "rgba(191, 178, 38, 1)"
            }, { // Possible but very difficult
                label: ["Possible but very difficult"],
                data: [5, 38, 5, 6, 35],
                backgroundColor: "rgba(255, 165, 0, 1)",
                hoverBackgroundColor: "rgba(188, 134, 35, 1)"
            }, { // Too difficult to access
                label: ["Too difficult to access"],
                data: [1, 22, 14, 0, 43],
                backgroundColor: "rgba(219, 21, 21, 1)",
                hoverBackgroundColor: "rgba(119, 17, 17, 1)"
            }, { // blanks
                label: ["Chose not to answer"],
                data: [76, 137, 310, 240, 248],
                backgroundColor: "rgba(155, 155, 155, 1)"
            }]
        },

        options: barOptions_stacked,
    });

    document.getElementById("myBarChart").onclick = function (evt) {
        var activePoint = myChart.getElementAtEvent(evt)[0];
        var data = activePoint._chart.data;
        var datasetIndex = activePoint._datasetIndex;
        var label = data.datasets[datasetIndex].label;
        var value = data.datasets[datasetIndex].data[activePoint._index];
        console.log(label, value);
    }

    // Onclick event
    canvas.onclick = function(evt) {
        var activePoint = myChart.getElementAtEvent(evt)[0];
        var data = activePoint._chart.data;
        var datasetIndex = activePoint._datasetIndex;
        var label = data.datasets[datasetIndex].label;
        var value = data.datasets[datasetIndex].data[activePoint._index];
        console.log(label, value);
    };
    // Onclick event

    // TESSST
//    var chartData = {
//        type: 'horizontalBar',
//        data: {
//            labels: ['A0224', 'A3681', 'A3984', 'A4101', 'A4150', 'B0682', 'Others'],
//            datasets: [{
//                label: "P1",
//                backgroundColor: '#cc3399',
//                data: [6, 7, 6, 8, 6, 10, 3]
//            }, {
//                label: "P2",
//                backgroundColor: '#0099ff',
//                data: [8, 9, 5, 8, 6, 10, 3]
//            }, {
//                label: "P3",
//                backgroundColor: '#0022ff',
//                data: [6, 7, 6, 8, 6, 10, 3]
//            }]
//        },
//        options: {
//            responsive: false,
//            legend: {
//                display: false
//            },
//            scales: {
//                yAxes: [{
//                    stacked: true
//                }],
//                xAxes: [{
//                    stacked: true
//                }]
//            },
//
//        }
//    }
//
//    var canvas = document.getElementById('createCurrYearHccGapChart');
//    var hello = new Chart(canvas, chartData);

    canvas.onclick = function(evt) {
        var activePoint = myChart.getElementAtEvent(evt)[0];
        var data = activePoint._chart.data;
        var datasetIndex = activePoint._datasetIndex;
        var label = data.datasets[datasetIndex].label;
        var value = data.datasets[datasetIndex].data[activePoint._index];
        console.log(label, value);
    };
    // TESSST

</script>

</body>
</html>