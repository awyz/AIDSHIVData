<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <!-- Chart.js MAKE SURE YOU'RE USING THE MOST UPDATED VERSION! -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>


    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom fonts for this template -->
    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>

    <!-- Plugin CSS -->
    <link href="vendor/magnific-popup/magnific-popup.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/creative.min.css" rel="stylesheet">

    <!-- JQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

</head>
<body>

<!-- BAR CHART -->
<div class="container">
    <canvas id="myBarChart"></canvas>
</div>

&nbsp;&nbsp;&nbsp;&nbsp;

<div class="container" style="border: 2px solid rgb(188, 188, 188)">
    &nbsp;

    <div style="text-align: center" id="instructions"><h3>Click on a section of the bar chart for more information</h3>
    <p>n = 398</p></div>

    <div id="hivDesc">
        HIV Case management easy description
    </div>

    <div id="dentalDesc">
        Dental easy description
    </div>

    <div id="counselingDesc">
        Counseling easy description
    </div>

    <div id="infoDesc">
        Info easy description
    </div>

    <div id="altTherapyDesc">
        Alt Therapy easy description
    </div>

    &nbsp;
</div>

<script>
    // todo Change the fonts

    var group;

    var barOptions_stacked = {
        hover :{
            animationDuration:0
        },
        scales: {
            xAxes: [{
                ticks: {
                    beginAtZero:true,
                    fontFamily: "'Open Sans Bold', sans-serif",
                    fontSize:11
                },
                scaleLabel:{
                    display:false
                },
                gridLines: {
                },
                stacked: true
            }],
            yAxes: [{
                gridLines: {
                    display:false,
                    color: "#fff",
                    zeroLineColor: "#fff",
                    zeroLineWidth: 0
                },
                ticks: {
                    fontFamily: "'Open Sans Bold', sans-serif",
                    fontSize:11
                },
                stacked: true
            }]
        },
        legend:{
            display:false
        },
        pointLabelFontFamily : "Quadon Extra Bold",
        scaleFontFamily : "Quadon Extra Bold",
        title: {
            text: "Difficulty to access care",
            display: true
        },
        legend: {
            display: true,
        },
        // test
        tooltips: {
            callbacks: {
                label: function(tooltipItems, data) {
                    return data.datasets[tooltipItems.datasetIndex].label + ': ' + tooltipItems.xLabel; // todo add percentages!
                },
                afterLabel: function (tooltipItem, data) {
                    var total = 0;
                    for (i = 0; i < data.datasets.length; i++) {
                        total += data.datasets[i].data[tooltipItem.datasetIndex];
                    }
                    var percent = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index] / total * 100;
                    percent = percent.toFixed(2);
                    return "Percentage: " + percent;
                }
            }
        }
        // test
    };



    var ctx = document.getElementById("myBarChart");
    var myChart = new Chart(ctx, {
        type: 'horizontalBar',
        data: {
            labels: ["HIV Case Management", "Dental Care", "Counseling", "Information", "Alternative Therapy"],

            datasets: [{ // Easy
                label: "Easy",
                data: [277, 134, 54, 120, 29],
                backgroundColor: "rgb(83, 226, 119)",
                hoverBackgroundColor: "rgba(66, 175, 94, 1)"
            },{ // Possible but required some work
                label: "Possible with some work",
                data: [39, 67, 15, 32, 43],
                backgroundColor: "rgba(255, 233, 0, 1)",
                hoverBackgroundColor: "rgba(191, 178, 38, 1)"
            }, { // Possible but very difficult
                label: "Possible but very difficult",
                data: [5, 38, 5, 6, 35],
                backgroundColor: "rgba(255, 165, 0, 1)",
                hoverBackgroundColor: "rgba(188, 134, 35, 1)"
            }, { // Too difficult to access
                label: "Too difficult to access",
                data: [1, 22, 14, 0, 43],
                backgroundColor: "rgba(219, 21, 21, 1)",
                hoverBackgroundColor: "rgba(119, 17, 17, 1)"
            }, { // blanks
                label: "Chose not to answer",
                data: [76, 137, 310, 240, 248],
                backgroundColor: "rgba(155, 155, 155, 1)"
            }]
        },

        options: barOptions_stacked,
    });

    // Hide everything
    window.onload=function(){
        document.getElementById("hivDesc").style.display='none';
        document.getElementById("dentalDesc").style.display='none';
        document.getElementById("counselingDesc").style.display='none';
        document.getElementById("infoDesc").style.display='none';
        document.getElementById("altTherapyDesc").style.display='none';
    }

    document.getElementById("myBarChart").onclick = function (evt) {
        var activePoint = myChart.getElementAtEvent(evt)[0];
        var data = activePoint._chart.data;
        var datasetIndex = activePoint._datasetIndex;
        var label = data.datasets[datasetIndex].label;
        var value = data.datasets[datasetIndex].data[activePoint._index];

        console.log("index: " + datasetIndex);
        console.log(myChart.data.labels[activePoint._index]);

        function closeAll() {
            console.log("Close everything");
            document.getElementById("hivDesc").style.display='none';
            document.getElementById("dentalDesc").style.display='none';
            document.getElementById("counselingDesc").style.display='none';
            document.getElementById("infoDesc").style.display='none';
            document.getElementById("altTherapyDesc").style.display='none';
        }

        console.log(label, value, datasetIndex);
        closeAll();



        switch(myChart.data.labels[activePoint._index]) {
            case ("HIV Case Management"): // HIV Case Management
                document.getElementById("instructions").style.display = "none";
                var x = document.getElementById("hivDesc");
                if(x.style.display == "block") {
                    x.style.display = "none";
                }
                else {
                    x.style.display = "block";
                }
                break;

            case ("Dental Care"): // Dental
                document.getElementById("instructions").style.display = "none";
                var x = document.getElementById("dentalDesc");
                if(x.style.display == "block")
                    x.style.display = "none"
                else
                    x.style.display = "block";
                break;

            case ("Counseling"): // Counseling
                document.getElementById("instructions").style.display = "none";
                var x = document.getElementById("counselingDesc");
                if(x.style.display == "block")
                    x.style.display = "none"
                else
                    x.style.display = "block";
                break;

            case ("Information"): // Info
                document.getElementById("instructions").style.display = "none";
                var x = document.getElementById("infoDesc");
                if(x.style.display == "block")
                    x.style.display = "none"
                else
                    x.style.display = "block";
                break;

            case ("Alternative Therapy"): // Easy alt therapy
                document.getElementById("instructions").style.display = "none";
                var x = document.getElementById("altTherapyDesc");
                if(x.style.display == "block")
                    x.style.display = "none"
                else
                    x.style.display = "block";
                break;

//            case ("Possible with some work" && 39): // Medium HIV care
//                document.getElementById("instructions").style.display = "none";
//                var x = document.getElementById("hivYellowDesc");
//                if (x.style.display == "block")
//                    x.style.display = "none"
//                else
//                    x.style.display = "block";
//                break;
        }

    }

    // TESSST


</script>

</body>
</html>